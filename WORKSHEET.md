# شرح کار و لاگ تغییرات پروژه

این فایل به عنوان ورکشیت و لاگ برای ثبت تمام تغییرات و بهبودهای اعمال شده در داشبورد مدیریت تولید عمل می‌کند. هر تسک جدید در بالای لیست اضافه خواهد شد.

---

### لاگ تغییرات

**تاریخ: 2024-08-12**
*   **تسک:** بازطراحی پنجره صدور دستور تولید و بررسی جامع سیستم
*   **توضیحات:**
    1.  **رفع باگ و بازطراحی پنجره صدور دستور تولید:**
        *   پنجره صدور دستور تولید (در ماژول فایل‌ها) که دچار مشکل ظاهری شده بود، به طور کامل بازطراحی و بهینه شد. چیدمان آن اکنون به صورت دو ستونی و واکنش‌گرا (responsive) است و دکمه‌ها و آیتم‌ها به درستی نمایش داده می‌شوند.
        *   لیست آیتم‌ها اکنون دارای اسکرول داخلی است تا از کشیده شدن پنجره در لیست‌های طولانی جلوگیری شود.
    2.  **ارتقاء بزرگ: آنالیز هوشمند مواد اولیه:**
        *   قابلیت آنالیز پیش از تولید به طور چشمگیری ارتقا یافت. اکنون علاوه بر بررسی **موجودی محصول آماده**، سیستم به صورت خودکار **نیاز به مواد اولیه** را بر اساس استانداردهای مصرف (BOM) محاسبه کرده و هرگونه کسری را به شما هشدار می‌دهد. این آنالیز دوگانه یک نمای کامل از آمادگی انبار برای تولید سفارش جدید ارائه می‌دهد.
    3.  **بررسی جامع و تایید یکپارچگی سیستم:**
        *   کل گردش کار سیستم، از بارگذاری فایل تا تکمیل نهایی بچ، مورد بازبینی قرار گرفت. تمام قابلیت‌هایی که اخیراً اضافه شده بودند (مانند حذف بچ، وضعیت‌های چاپ، کنسل کردن سفارش) تست و صحت عملکرد آن‌ها در هماهنگی با یکدیگر تایید شد.
        *   **شفاف‌سازی منطق مواد اولیه:** بررسی شد که سیستم در حال حاضر از ماژول مواد اولیه به عنوان یک ابزار تحلیلی و نظارتی استفاده می‌کند و به صورت خودکار از انبار مواد کسر نمی‌کند. بنابراین، کنسل کردن یک بچ نیازی به "بازگرداندن" مواد ندارد، زیرا هیچ ماده‌ای کسر نشده است. این منطق در کل سیستم یکپارچه است.

**تاریخ: 2024-08-11**
*   **تسک:** بهبود یکپارچگی ماژول‌ها و رهگیری بچ
*   **توضیحات:**
    1.  **منطق جدید حذف بچ:** عملکرد دکمه "حذف بچ" در ماژول "رهگیری تولید" بازبینی شد. اکنون با حذف یک بچ:
        *   کد بچ از تمام آیتم‌های مرتبط در کل سیستم (گزارش جامع و در دست چاپ) حذف می‌شود.
        *   وضعیت آیتم‌ها به "درحال انجام" بازمی‌گردد، **مگر اینکه** آیتم در وضعیت "در دست چاپ" یا "چاپ شده" باشد. این کار از اختلال در فرآیند چاپ جلوگیری می‌کند.
        *   این دکمه اکنون برای تمام بچ‌های فعال (کنسل نشده و تکمیل نشده) در دسترس است.
    2.  **ارتقاء ماژول در دست چاپ:** یک ستون جدید "کد بچ" به جدول ماژول "در دست چاپ" اضافه شد. این ستون به صورت خودکار با اختصاص کد بچ در گزارش جامع، به‌روزرسانی می‌شود و به رهگیری بهتر آیتم‌های چاپی کمک می‌کند.

**تاریخ: 2024-08-10**
*   **تسک:** رفع باگ بحرانی ذخیره‌سازی
*   **توضیحات:**
    1.  **رفع خطای Circular Structure:** یک باگ مهم که باعث خطای `Converting circular structure to JSON` هنگام ذخیره اطلاعات در پایگاه داده می‌شد، برطرف گردید. این خطا مانع از ذخیره تغییرات در برخی شرایط می‌شد.
    2.  **بهبود پایداری:** برای جلوگیری از بروز مجدد این مشکل، فرآیند ذخیره‌سازی اطلاعات بازبینی شد. اکنون قبل از ارسال داده‌ها به سرور، یک نسخه کاملاً پاک و بهینه از وضعیت برنامه ایجاد می‌شود تا از صحت و سلامت داده‌ها اطمینان حاصل شود. این کار پایداری کلی سیستم را افزایش می‌دهد.

**تاریخ: 2024-08-09**
*   **تسک:** بهبود گردش کار، بایگانی و مدیریت خطا
*   **توضیحات:**
    1.  **کنسل کردن بچ و بازگشت مواد:** قابلیت کنسل کردن بچ در ماژول "رهگیری تولید" تایید و نهایی شد. این عمل وضعیت تمام آیتم‌های بچ را به "ابطال" تغییر داده و مواد اولیه مصرفی را به صورت خودکار به انبار باز می‌گرداند.
    2.  **حذف بچ کنسل شده:** یک قابلیت جدید اضافه شد که به کاربر اجازه می‌دهد بچ‌های کنسل شده را از لیست "رهگیری تولید" حذف کند تا این نما خلوت‌تر شود. سوابق آیتم‌های مربوطه در گزارش جامع باقی می‌ماند.
    3.  **انعطاف در تخصیص کد بچ:** اکنون می‌توان به آیتم‌هایی که در وضعیت "در دست چاپ" هستند نیز کد بچ اختصاص داد که باعث افزایش انعطاف‌پذیری در مدیریت تولید می‌شود.
    4.  **بایگانی در ماژول چاپ:** ماژول "در دست چاپ" بهبود یافت. آیتم‌ها پس از تغییر وضعیت به "چاپ شده"، از لیست حذف نمی‌شوند و برای گزارش‌گیری و حفظ سوابق در ماژول باقی می‌مانند.
    5.  **مدیریت سفارشات کارمزدی:** قابلیت حذف سفارشات تولید کارمزدی به صورت مستقیم از طریق دکمه "حذف" در "گزارش جامع" تایید و نهایی شد تا مدیریت این نوع سفارشات ساده‌تر شود.
    6.  **همگام‌سازی وضعیت‌ها:** معماری سیستم تضمین می‌کند که هرگونه تغییر وضعیت در یک ماژول (مانند گزارش جامع) به صورت خودکار در تمام بخش‌های دیگر سیستم منعکس می‌شود.

**تاریخ: 2024-08-08**
*   **تسک:** افزودن قابلیت‌های کنترلی و بهبود گردش کار
*   **توضیحات:**
    1.  **کنسل کردن بچ تولید:** در ماژول "رهگیری تولید"، دکمه "کنسل" برای هر بچ اضافه شد. این عمل وضعیت تمام آیتم‌های بچ را به "ابطال" تغییر داده و مواد اولیه مصرفی را به صورت خودکار به انبار باز می‌گرداند.
    2.  **انعطاف در تخصیص کد بچ:** اکنون می‌توان به آیتم‌هایی که در وضعیت "در دست چاپ" یا "چاپ شده" هستند نیز کد بچ اختصاص داد که باعث افزایش انعطاف‌پذیری در مدیریت تولید می‌شود.
    3.  **بایگانی در ماژول چاپ:** ماژول "در دست چاپ" بهبود یافت. آیتم‌ها پس از تغییر وضعیت به "چاپ شده"، از لیست حذف نمی‌شوند و برای گزارش‌گیری و حفظ سوابق در ماژول باقی می‌مانند.
    4.  **مدیریت سفارشات کارمزدی:** قابلیت حذف سفارشات تولید کارمزدی به صورت مستقیم از طریق دکمه "حذف" در "گزارش جامع" اضافه شد تا مدیریت این نوع سفارشات ساده‌تر شود.

**تاریخ: 2024-08-07**
*   **تسک:** اصلاح منطق صدور دستور تولید
*   **توضیحات:**
    1.  **اصلاح وضعیت:** منطق صدور دستور تولید از "مدیریت فایل" اصلاح شد. اکنون وقتی یک آیتم به تولید ارسال می‌شود، وضعیت آن در همان ماژول به "درحال انجام" تغییر می‌کند (به جای "انجام شده") و تعداد آن در کارت‌های خلاصه به درستی نمایش داده می‌شود.
    2.  **پشتیبانی از دستورات جزئی:** سیستم اکنون به طور هوشمند از صدور دستور تولید برای بخشی از تعداد یک آیتم پشتیبانی می‌کند. در این حالت، آیتم اصلی به دو بخش تقسیم می‌شود: بخش "درحال انجام" و بخش "آماده تولید" که در لیست باقی می‌ماند.

**تاریخ: 2024-08-06**
*   **تسک:** بهبود ماژول استاندارد مواد و آنالیز صدور دستور تولید
*   **توضیحات:**
    1.  **بهبود ماژول مواد:** فیلد "واحد سنجش" در بخش تعریف دستی مواد اولیه، از یک فیلد متنی به یک لیست کشویی (dropdown) با واحدهای استاندارد (عدد، کیلوگرم، متر و...) تغییر یافت تا ورود داده‌ها دقیق‌تر و یکپارچه‌تر شود.
    2.  **بهبود آنالیز موجودی:** در پنجره "صدور دستور تولید"، منطق "آنالیز موجودی محصول آماده" اصلاح شد. اکنون سیستم به جای نمایش نیاز برای هر محصول مجزا، نیازها را بر اساس `گروه محصول`، `رنگ` و `سایز` تجمیع کرده و یک گزارش خلاصه‌تر و دقیق‌تر از نیاز واقعی به تولید ارائه می‌دهد.

**تاریخ: 2024-08-05**
*   **تسک:** یکپارچه‌سازی وضعیت‌ها در تمام ماژول‌ها
*   **توضیحات:**
    1.  **همگام‌سازی وضعیت بچ و آیتم‌ها:** یک منطق همگام‌سازی دوطرفه پیاده‌سازی شد. اکنون با "تکمیل کردن" یک بچ در ماژول رهگیری، وضعیت تمام آیتم‌های مرتبط با آن در کل سیستم به "انجام شده" تغییر می‌کند.
    2.  **به‌روزرسانی خودکار وضعیت بچ:** برعکس، اگر وضعیت تمام آیتم‌های یک بچ در "گزارش جامع" به صورت دستی به "انجام شده" تغییر کند، وضعیت خود بچ نیز به صورت خودکار به "تکمیل شده" تغییر می‌یابد. این یکپارچگی، ردگیری و کنترل فرآیندها را در تمام ماژول‌ها تضمین می‌کند.

**تاریخ: 2024-08-04**
*   **تسک:** بهینه‌سازی فرم چاپ دستور تولید
*   **توضیحات:**
    1.  **بهبود چیدمان:** چیدمان فرم چاپی دستور تولید تغییر کرد. چک‌لیست مراحل تکمیل‌شده اکنون به صورت یک ستون مجزا در سمت راست لیست آیتم‌ها نمایش داده می‌شود تا فرم خواناتر و منظم‌تر باشد.
    2.  **افزودن جمع کل:** یک ردیف "جمع کل" به انتهای جدول آیتم‌ها در فرم چاپ اضافه شد تا تعداد کل محصولات تولیدی در بچ به وضوح مشخص باشد.

**تاریخ: 2024-08-03**
*   **تسک:** تفکیک وضعیت تکمیل بچ از مراحل تولید
*   **توضیحات:**
    1.  **حذف تکمیل خودکار:** منطق تکمیل خودکار بچ با تیک خوردن تمام مراحل تولید حذف شد. اکنون وضعیت تکمیل بچ مستقل از چک‌باکس‌ها است.
    2.  **افزودن دکمه تکمیل دستی:** یک دکمه جدید "تکمیل بچ" به هر ردیف در جدول رهگیری تولید اضافه شد. با استفاده از این دکمه، کاربر می‌تواند به صورت دستی یک بچ را تکمیل کند. این عمل، تاریخ تکمیل را ثبت کرده و تمام مراحل را نیز به صورت خودکار تیک می‌زند.

**تاریخ: 2024-08-02**
*   **تسک:** بازطراحی چاپ بچ، شمسی‌سازی کدبچ و بهبود رهگیری
*   **توضیحات:**
    1.  **بازطراحی فرم چاپ بچ:**
        *   فرم چاپی دستور تولید به طور کامل بازطراحی شد. طراحی جدید به صورت یک لیست مدرن و خوانا است و کد بچ به صورت بزرگ و برجسته در مرکز آن نمایش داده می‌شود.
        *   چک‌لیست تولید در فرم چاپ، اکنون هوشمند شده و فقط مراحلی را نمایش می‌دهد که در سیستم به عنوان "تکمیل شده" علامت‌گذاری شده‌اند.
    2.  **شمسی‌سازی کد بچ:**
        *   الگوریتم تولید کد بچ به طور کامل به تقویم شمسی منتقل شد. کد جدید بر اساس روز و ماه جاری شمسی و شمارنده تولید در همان ماه شمسی تولید می‌شود.
    3.  **ارتقاء جدول رهگیری تولید:**
        *   یک ستون جدید با عنوان "گروه محصول" به جدول اضافه شد تا شناسایی محتوای هر بچ سریع‌تر شود.
        *   یک ستون هوشمند با عنوان "مدت زمان" اضافه شد که به صورت خودکار زمان صرف شده از صدور تا تکمیل نهایی هر بچ را محاسبه و نمایش می‌دهد.

**تاریخ: 2024-08-01**
*   **تسک:** بهبود تجربه کاربری و طراحی مجدد چاپ در رهگیری تولید
*   **توضیحات:**
    1.  **بهبود UX رهگیری تولید:**
        *   مشکل بسته شدن خودکار بخش "جزئیات" هنگام تغییر وضعیت چک‌باکس‌ها حل شد تا کاربر بتواند به راحتی مراحل را مدیریت کند.
        *   لیست آیتم‌ها از بخش جزئیات حذف شد تا رابط کاربری ساده‌تر و متمرکزتر باشد.
    2.  **بازطراحی چاپ بچ تولید:**
        *   فرم چاپی بچ تولید به طور کامل بازطراحی شد. طراحی جدید، مدرن، زیبا و کاربردی است.
        *   آیتم‌ها در فرم چاپ بر اساس `گروه محصول`، `رنگ` و `سایز` تجمیع می‌شوند تا یک گزارش خلاصه و دقیق ارائه شود.

**تاریخ: 2024-07-31**
*   **تسک:** ارتقاء ماژول رهگیری تولید و بهینه‌سازی چاپ
*   **توضیحات:**
    1.  **ارتقاء رهگیری تولید:**
        *   **مدیریت مواد اولیه:** در بخش جزئیات هر بچ، قابلیت فراخوانی هوشمند مواد اولیه استاندارد و همچنین امکان افزودن دستی مواد (خرج کار) اضافه شد.
        *   **چاپ اختصاصی بچ:** برای هر بچ تولید یک دکمه "چاپ" مجزا تعبیه شد. خروجی چاپی شامل لیست کامل آیتم‌ها، چک‌لیست مراحل تولید و لیست جامع مواد اولیه (استاندارد و دستی) می‌باشد.
    2.  **بهبود چاپ:**
        *   خروجی چاپ در ماژول "در دست چاپ" بهینه شد تا آیتم‌ها را بر اساس `گروه محصول`، `رنگ` و `سایز` تجمیع کرده و یک گزارش خلاصه‌ و کاربردی ارائه دهد.

**تاریخ: 2024-07-30**
*   **تسک:** بازبینی ماژول رهگیری و اصلاح کد بچ
*   **توضیحات:**
    1.  **بهبود ماژول رهگیری تولید:** بخش جزئیات در این ماژول مجدداً ساماندهی شد تا لیست آیتم‌ها و چک‌لیست مراحل تولید به صورت منظم و خوانا نمایش داده شود. همچنین مرحله "چاپ و پرس" به چک‌لیست مراحل بازگردانده شد.
    2.  **اصلاح الگوریتم کد بچ:** منطق تولید کد بچ به طور کامل تغییر کرد. فرمت جدید به صورت `[A/K][روز جاری][ماه جاری][شمارنده ماهانه]` (مثال: `A581`) است و شمارنده به درستی در ابتدای هر ماه صفر می‌شود.

**تاریخ: 2024-07-29**
*   **تسک:** بهبود فیلترینگ گزارش جامع
*   **توضیحات:**
    1.  **افزودن فیلترهای جدید:** فیلترهای `رنگ` و `سایز` به ماژول "گزارش جامع" اضافه شد.
    2.  **افزودن جستجو:** یک فیلد جستجو برای `کد طرح` (SKU) اضافه شد تا بتوان به سرعت آیتم‌های خاص را پیدا کرد. این بهبودها به کاربران امکان می‌دهد تا گزارش‌ها را با دقت و جزئیات بیشتری تحلیل کنند.

**تاریخ: 2024-07-28**
*   **تسک:** بهبود گردش کار چاپ و فیلترینگ
*   **توضیحات:**
    1.  **بهبود گزارش جامع:**
        *   یک دکمه اختصاصی "ارسال برای چاپ" اضافه شد تا آیتم‌های "درحال انجام" به راحتی به ماژول چاپ منتقل شوند.
        *   آیتم‌هایی که در وضعیت "در دست چاپ" هستند، دیگر برای اختصاص کد بچ قابل انتخاب نیستند تا از خطاهای احتمالی در فرآیند تولید جلوگیری شود.
    2.  **بهبود ماژول در دست چاپ:**
        *   فیلترهای جدیدی برای `رنگ` و `سایز` به این ماژول اضافه شد تا کاربران بتوانند لیست کارهای چاپی را با دقت بیشتری مدیریت و بررسی کنند.

**تاریخ: 2024-07-27**
*   **تسک:** افزودن ماژول و گردش کار "در دست چاپ"
*   **توضیحات:**
    1.  **وضعیت جدید:** یک وضعیت جدید به نام `در دست چاپ` به چرخه تولید اضافه شد تا فرآیند چاپ به صورت مجزا قابل رهگیری باشد.
    2.  **ماژول جدید:** یک ماژول کاملاً جدید به نام "در دست چاپ" ایجاد شد. آیتم‌ها پس از تغییر وضعیت از "گزارش جامع"، به این ماژول منتقل می‌شوند.
    3.  **گردش کار:** در ماژول جدید، می‌توان وضعیت آیتم‌ها را به "چاپ شده" تغییر داد. با این کار، وضعیت اصلی آن‌ها به `درحال انجام` برمی‌گردد و مجدداً در "گزارش جامع" برای اختصاص کد بچ در دسترس قرار می‌گیرند.
    4.  **امکانات کامل:** ماژول "در دست چاپ" شامل تمام امکانات استاندارد مانند فیلترهای پیشرفته، خروجی اکسل، و دکمه چاپ لیست کار می‌باشد.

**تاریخ: 2024-07-26**
*   **تسک:** بهبود ماژول‌های چاپ و موجودی
*   **توضیحات:**
    1.  **بهبود چاپ رهگیری تولید:** منطق چاپ دستور تولید تغییر کرد تا آیتم‌ها بر اساس `گروه محصول`، `رنگ` و `سایز` تجمیع شوند (به جای `نام محصول`). این کار باعث ایجاد یک خلاصه سفارش تمیزتر و کاربردی‌تر می‌شود.
    2.  **ارتقاء ماژول موجودی:** ماژول موجودی به طور کامل بازطراحی شد تا `رنگ` و `سایز` را نیز شامل شود. اکنون موجودی به صورت دقیق برای هر نوع محصول قابل رهگیری است. آنالیز موجودی در هنگام صدور دستور تولید نیز به‌روزرسانی شد تا اطلاعات دقیقی از موجودی هر آیتم خاص (با رنگ و سایز) ارائه دهد و نیاز واقعی به تولید را مشخص کند.

**تاریخ: 2024-07-25**
*   **تسک:** ایجاد فایل ورکشیت (شرح کار)
*   **توضیحات:** بنا به درخواست کاربر، این فایل (`WORKSHEET.md`) برای ثبت و رهگیری تمام فعالیت‌ها و تغییرات اعمال شده روی پروژه ایجاد شد. این فایل به عنوان یک لاگ دائمی عمل خواهد کرد.